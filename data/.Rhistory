library(tidyverse)
library(dplyr)
setwd('C:/Users/xr49abiw/Documents/DispersalProject/data')
db5 <- read.csv("DispersalTransformed.csv")
# Filtering for mean, median, and maximum distances
meandb <- filter(db5, Statistic == "Mean")
meddb <- filter(db5, Statistic == "Median")
maxdb <- filter(db5, Statistic == "Maximum")
#### Linear regression for maximum by movement modes####
# Filtering for maximum distances and grouping by Movement Mode
maxmovdb <- filter(db5, Statistic == "Maximum") |>
group_by(Movement.Mode)
maxmovdb <- maxmovdb |>
filter(!is.na(Movement.Mode))
#### Linear regression for maximum (differentiated by Movement Mode) ####
# Log10 transform
maxmovdb <- maxmovdb |>
mutate(log10_Body.mass = log10(Body.mass),
log10_Distance = log10(Value))
# Linear regression model for each Movement Mode and extracting the slopes (coefficients)
regressions_maxmov <- maxmovdb |>
group_by(Movement.Mode) |>
do(model = lm(log10_Distance ~ log10_Body.mass, data = .))
# Summarize the regression models
summaries <- regressions_maxmov |>
group_map(~ summary(.x$model))
# Create scatter plots for each Movement Mode
scatter_plots_maxmov <- maxmovdb |>
ggplot(aes(x = log10_Body.mass, y = log10_Distance, color = Movement.Mode)) +
geom_point(size = 1, alpha = 0.2) +  # Adjust size and transparency
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Log10 Body mass (g)", y = "Log10 maximum Dispersal distance (m)") +
theme_minimal()
print(scatter_plots_maxmov)
